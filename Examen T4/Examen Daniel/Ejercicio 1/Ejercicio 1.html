<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <title>Ejercicio 1</title>

    <!-- Estilos en un fichero externo que no tendrás que modificar -->
    <link rel="stylesheet" type="text/css" href="estilos1.css" />

    <script type="text/javascript">
        document.addEventListener("DOMContentLoaded", () => {
            // Constantes con la rotación y desplazamiento que hay que llevar a cabo
            const DESP = 70;
            const ROT = 360;

            //Para obtener el número de milisegundos en los que se ejecuta una animación
            function getMilisegundos() {
                return document.querySelector("input[name='segundos']").value * 1000;
            }

            //Esta función se encarga de desplazar la imagen			
            function desplazar() {
                var milisegundos = getMilisegundos();
                var tiemp = document.getElementsByClassName('activador');
                var pelota = document.querySelector('.pelota');
                var inter, cont, tiempVal;
                var posOrig, anim;
                var start = null;


                console.log(posOrig);
                if (!pulsad) {
                    pulsad = true;
                    console.log(pelota.offsetLeft);
                    if (tiemp[1].value == 0 || tiemp[1].value == '') {
                        alert('Debe introducir un número de segundos mayor que cero ');
                    } else {
                        tiempVal = parseInt(tiemp[1].value);



                        function step(timestamp) {
                            if (!start) {
                                start = timestamp;
                                var progress = timestamp - start;
                                pelota.style.transition = 'transform ' + tiemp[1].value + 's';
                                pelota.style.transform = 'rotate(' + ROT + 'deg)';
                                pelota.style.transform = 'translate(' + (screen.width * DESP / 100) + 'px) rotate(' + ROT + 'deg)';

                                if (progress < tiempVal * 1000) {
                                    window.requestAnimationFrame(step);
                                }
                            }
                        }
                        anim = window.requestAnimationFrame(step);


                    }
                } else {
                    window.cancelAnimationFrame(anim);
                    pelota.style.transform = 'translate(-' + (screen.width * DESP / 100) + 'px)';
                    pulsad = false;
                    console.log(pulsad);
                    pelota.style.left = '8px';
                }



            }

            //Por defecto se activa la animación						
            var pulsad = false;
            document.getElementById("pulsador").addEventListener("click", desplazar);

        });
    </script>
</head>

<body>
    <img id="pelota1" class="pelota" src="pelota1.png" />
    <div id="contenedor">
        <div id="pulsador" class="activador"><span>A rodar</span></div>
        <input type="text" name="segundos" size="5" class="activador"></input>
    </div>

</body>

</html>